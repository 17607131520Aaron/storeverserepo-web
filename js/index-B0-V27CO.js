import{i as e}from"./chunk-Dh7eWoLx.js";import{A as s,N as n,S as a,T as t,_ as l,k as i,w as r}from"./chunk--OXHFPkF.js";import{S as o,b as c,x as h,y as d}from"./chunk-BFd9lKtJ.js";import{$ as m,B as u,C as p,D as b,E as y,G as f,H as k,I as x,J as g,M as j,N as v,O as C,P as N,Q as S,S as w,U as T,V as E,Y as L,at as K,d as R,f as M,h as P,ht as $,it as I,l as D,m as O,n as z,st as V,u as A,ut as B,v as W,x as U,y as H,z as G}from"./chunk-q1kk2jx6.js";import{t as J}from"./chunk-D8HawuWE.js";import"./chunk-bmmvJARN.js";var Q=e(n(),1),Y=l(),_=()=>{const{theme:e,setTheme:s}=h(),n=o();return(0,Y.jsx)(O,{menu:{items:[{key:"light",label:"äº®è‰²æ¨¡å¼",icon:(0,Y.jsx)(p,{})},{key:"dark",label:"æš—è‰²æ¨¡å¼",icon:(0,Y.jsx)(j,{})},{key:"auto",label:"è·Ÿéšç³»ç»Ÿ",icon:(0,Y.jsx)("span",{children:"ðŸ”„"})}],selectedKeys:[e],onClick:({key:e})=>{["light","dark","auto"].includes(e)&&s(e)}},placement:"bottomRight",children:(0,Y.jsx)(I,{icon:"dark"===n?(0,Y.jsx)(j,{}):(0,Y.jsx)(p,{}),title:"åˆ‡æ¢ä¸»é¢˜",type:"text"})})};const q=[{key:"/",icon:(0,Y.jsx)(G,{}),label:"é¦–é¡µ"},{key:"dashboard",icon:(0,Y.jsx)(S,{}),label:"ä»ªè¡¨ç›˜",children:[{key:"/dashboard/overview",icon:(0,Y.jsx)(L,{}),label:"æ•°æ®æ¦‚è§ˆ"},{key:"/dashboard/analysis",icon:(0,Y.jsx)(S,{}),label:"ç»Ÿè®¡åˆ†æž"},{key:"/dashboard/map3d",icon:(0,Y.jsx)(u,{}),label:"3Dåœ°å›¾"}]},{key:"documents",icon:(0,Y.jsx)(k,{}),label:"æ–‡æ¡£ç®¡ç†",children:[{key:"/documents/list",icon:(0,Y.jsx)(k,{}),label:"æ–‡æ¡£åˆ—è¡¨"},{key:"/documents/category",icon:(0,Y.jsx)(E,{}),label:"æ–‡æ¡£åˆ†ç±»"},{key:"/documents/trash",icon:(0,Y.jsx)(f,{}),label:"å›žæ”¶ç«™"}]},{key:"team",icon:(0,Y.jsx)(w,{}),label:"å›¢é˜Ÿç®¡ç†",children:[{key:"/team/members",icon:(0,Y.jsx)(W,{}),label:"æˆå‘˜ç®¡ç†"},{key:"/team/roles",icon:(0,Y.jsx)(H,{}),label:"è§’è‰²æƒé™"},{key:"/team/departments",icon:(0,Y.jsx)(w,{}),label:"éƒ¨é—¨ç®¡ç†"}]},{key:"barcode",icon:(0,Y.jsx)(L,{}),label:"æ¡ç ç®¡ç†",children:[{key:"/barcode/manage",icon:(0,Y.jsx)(L,{}),label:"æ¡ç ç”Ÿæˆ"}]},{key:"settings",icon:(0,Y.jsx)(y,{}),label:"ç³»ç»Ÿè®¾ç½®",children:[{key:"/settings/basic",icon:(0,Y.jsx)(y,{}),label:"åŸºç¡€è®¾ç½®"},{key:"/settings/security",icon:(0,Y.jsx)(b,{}),label:"å®‰å…¨è®¾ç½®"},{key:"/settings/logs",icon:(0,Y.jsx)(T,{}),label:"æ—¥å¿—ç®¡ç†"}]},{key:"rndebug",icon:(0,Y.jsx)(g,{}),label:"react nativeè°ƒè¯•å·¥å…·",children:[{key:"/smartserviceappDebug/debuglogs",icon:(0,Y.jsx)(U,{}),label:"æ—¥å¿—"},{key:"/smartserviceappDebug/network",icon:(0,Y.jsx)(m,{}),label:"ç½‘ç»œ"}]}],F=[{key:"profile",icon:(0,Y.jsx)(H,{}),label:"ä¸ªäººä¸­å¿ƒ"},{key:"settings",icon:(0,Y.jsx)(y,{}),label:"è´¦æˆ·è®¾ç½®"},{type:"divider"},{key:"logout",icon:(0,Y.jsx)(x,{}),label:"é€€å‡ºç™»å½•",danger:!0}],X=(0,Q.createContext)(void 0);s();const Z=()=>{const e=(0,Q.useContext)(X);if(!e)throw new Error("useTabs must be used within TabsProvider");return e},ee=()=>{const[e,s]=(0,Q.useState)(!1),[n,a]=(0,Q.useState)(""),l=t(),o=r(),{refreshKey:c,refreshingKey:h,setRefreshingKey:m,isTabSwitching:u}=Z(),[p,b]=(0,Q.useState)(!1),y=(0,Q.useRef)(null),{logout:f}=d(),k=e=>{const s=[];return null==q||q.forEach(n=>{n&&"string"!=typeof n&&"children"in n&&n.children&&n.children.some(s=>s&&"string"!=typeof s&&s.key===e)&&n.key&&s.push(n.key)}),s},x=(0,Q.useMemo)(()=>{const e=o.pathname||"/",s=[];return null==q||q.forEach(n=>{n&&"string"!=typeof n&&("/"!==n.key||"/"!==e&&""!==e?n.key===e?s.push(e):"children"in n&&n.children&&n.children.forEach(n=>{n&&"string"!=typeof n&&n.key===e&&s.push(e)}):s.push("/"))}),s.length>0?s:["/"]},[o.pathname]),[g,j]=(0,Q.useState)(()=>k(o.pathname||"/")),v=(0,Q.useMemo)(()=>n.trim()?((e,s)=>{const n=[],a=s.toLowerCase();return null==e||e.forEach(e=>{if(!e||"string"==typeof e||"divider"===e.type)return;const s="label"in e&&e.label?e.label.toString():"",t=s.toLowerCase();"children"in e&&e.children?(e.children.forEach(e=>{if(!e||"string"==typeof e||"divider"===e.type)return;const t="label"in e&&e.label?e.label.toString():"";t.toLowerCase().includes(a)&&n.push({key:e.key,label:t,parentLabel:s,icon:"icon"in e?e.icon:void 0})}),t.includes(a)&&e.key&&"string"==typeof e.key&&e.key.startsWith("/")&&n.push({key:e.key,label:s,icon:"icon"in e?e.icon:void 0})):t.includes(a)&&n.push({key:e.key,label:s,icon:"icon"in e?e.icon:void 0})}),n})(q,n):[],[n]),C=(0,Q.useMemo)(()=>((e,s)=>{if(!s.trim())return e;const n=[];return null==e||e.forEach(e=>{if(!e||"string"==typeof e||"divider"===e.type)return;const a="label"in e&&e.label?e.label.toString().toLowerCase():"",t=s.toLowerCase();if("children"in e&&e.children){const s=e.children.filter(e=>!(!e||"string"==typeof e||"divider"===e.type)&&("label"in e&&e.label?e.label.toString().toLowerCase():"").includes(t));(a.includes(t)||s.length>0)&&n.push(i(i({},e),{},{children:s.length>0?s:e.children}))}else a.includes(t)&&n.push(e)}),n})(q,n),[n]);(0,Q.useEffect)(()=>{if(n.trim()){const e=[];null==q||q.forEach(s=>{s&&"string"!=typeof s&&"divider"!==s.type&&"children"in s&&s.children&&s.children.some(e=>!(!e||"string"==typeof e||"divider"===e.type)&&("label"in e&&e.label?e.label.toString().toLowerCase():"").includes(n.toLowerCase()))&&s.key&&e.push(s.key)}),j(e)}},[n]),(0,Q.useEffect)(()=>{if(!n.trim()){const e=k(o.pathname||"/");j(s=>{const n=[...s];return e.forEach(e=>{n.includes(e)||n.push(e)}),n})}},[o.pathname,n]);(0,Q.useEffect)(()=>{const e=o.pathname||"/";if(null!==y.current&&y.current!==e&&!u){b(!0);const s=setTimeout(()=>{b(!1)},300);return y.current=e,()=>{clearTimeout(s)}}y.current=e},[o.pathname,u]),(0,Q.useEffect)(()=>{if(h&&c){const e=setTimeout(()=>{m(null)},300);return()=>{clearTimeout(e)}}},[c,h,m]);const N=o.pathname||"/",S=null!==h&&h===N;return{collapsed:e,setCollapsed:s,searchValue:n,setSearchValue:a,openKeys:g,selectedKeys:x,flatSearchResults:v,filteredMenuItems:C,isLoading:S||p,isRefreshing:S,refreshKey:c,handleMenuClick:({key:e})=>{e.startsWith("/")&&l(e)},handleOpenChange:e=>{j(e)},handleUserMenuClick:({key:e})=>{"logout"===e?f().then(()=>{l("/login",{replace:!0})}):"profile"===e?l("/profile"):"settings"===e&&l("/settings/basic")}}};var se=()=>{const{tabs:e,activeKey:s,setActiveTab:n,removeTab:a,closeOtherTabs:t,refreshTab:l}=Z(),i=(0,Q.useRef)(null),r=(0,Q.useRef)(null),[o,c]=(0,Q.useState)(new Set);(0,Q.useEffect)(()=>{if(r.current&&i.current){const e=i.current,s=r.current,n=e.getBoundingClientRect(),a=s.getBoundingClientRect();a.left<n.left?e.scrollLeft=s.offsetLeft-20:a.right>n.right&&(e.scrollLeft=s.offsetLeft-n.width+a.width+20)}},[s]);return(0,Y.jsx)("div",{className:"asp-tabs-bar",children:(0,Y.jsx)("div",{ref:i,className:"asp-tabs-bar-container",children:e.map(i=>{const h=i.key===s;return(0,Y.jsxs)("div",{ref:h?r:null,className:"asp-tabs-bar-item "+(h?"active":""),onClick:e=>((e,a)=>{a.stopPropagation(),e.key!==s&&n(e.key)})(i,e),onContextMenu:s=>((s,n)=>{n.preventDefault(),n.stopPropagation(),s.closable&&e.length>1&&t(s.key)})(i,s),children:[h&&(0,Y.jsx)("span",{className:"asp-tabs-bar-item-refresh "+(o.has(i.key)?"refreshing":""),title:"åˆ·æ–°é¡µé¢",onClick:e=>((e,s)=>{s.stopPropagation(),c(s=>new Set(s).add(e.key)),l(e.key),setTimeout(()=>{c(s=>{const n=new Set(s);return n.delete(e.key),n})},500)})(i,e),children:(0,Y.jsx)(C,{})}),(0,Y.jsx)("span",{className:"asp-tabs-bar-item-label",children:i.label}),i.closable&&(0,Y.jsx)("span",{className:"asp-tabs-bar-item-close",title:"å…³é—­æ ‡ç­¾",onClick:e=>((e,s)=>{s.stopPropagation(),a(e.key)})(i,e),children:(0,Y.jsx)($,{})})]},i.key)})})})},ne=e=>{const s=n=>{for(const a of n)if(a&&"string"!=typeof a){if(a.key===e&&"label"in a&&a.label)return"string"==typeof a.label?a.label:String(a.label);if("children"in a&&a.children){const e=s(a.children);if(e)return e}}return null};return s(q||[])||"æœªå‘½åé¡µé¢"};const ae=({children:e})=>{const s=r(),n=t(),[a,l]=(0,Q.useState)([{key:"/",label:"é¦–é¡µ",path:"/",closable:!1}]),[i,o]=(0,Q.useState)("/"),[c,h]=(0,Q.useState)(""),[d,m]=(0,Q.useState)(null),[u,p]=(0,Q.useState)(!1),b=(0,Q.useCallback)(e=>{l(s=>{if(s.find(s=>s.path===e))return s;const n={key:e,label:ne(e),path:e,closable:"/"!==e};return[...s,n]}),o(e)},[]),y=(0,Q.useCallback)(e=>{l(s=>{const a=s.filter(s=>s.key!==e);if(e===i&&a.length>0){const t=s.findIndex(s=>s.key===e),l=a[t>0?t-1:0];l&&(o(l.key),n(l.path))}return a})},[i,n]),f=(0,Q.useCallback)(e=>{o(e);const s=a.find(s=>s.key===e);s&&(p(!0),n(s.path),setTimeout(()=>{p(!1)},100))},[a,n]),k=(0,Q.useCallback)(e=>{l(s=>s.filter(s=>s.key===e||!s.closable)),o(e);const s=a.find(s=>s.key===e);s&&n(s.path)},[a,n]),x=(0,Q.useCallback)(()=>{l(e=>e.filter(e=>!e.closable)),o("/"),n("/")},[n]),g=(0,Q.useCallback)(e=>{const s=a.find(s=>s.key===e);s&&(m(e),window.dispatchEvent(new CustomEvent("tab-refresh",{detail:{path:s.path,key:e}})),h(`${s.path}-${Date.now()}`),e!==i&&n(s.path))},[a,n,i]);return(0,Q.useEffect)(()=>{b(s.pathname||"/")},[s.pathname,b]),(0,Q.useEffect)(()=>{o(s.pathname||"/")},[s.pathname]),(0,Y.jsx)(X.Provider,{value:{tabs:a,activeKey:i,refreshKey:c,refreshingKey:d,isTabSwitching:u,addTab:b,removeTab:y,setActiveTab:f,closeOtherTabs:k,closeAllTabs:x,refreshTab:g,setRefreshingKey:m,setIsTabSwitching:p},children:e})};var{Header:te,Sider:le,Content:ie}=R,{Text:re}=z,oe=()=>{const e=r(),{collapsed:s,setCollapsed:n,searchValue:t,setSearchValue:l,openKeys:i,selectedKeys:o,flatSearchResults:h,filteredMenuItems:d,isLoading:m,isRefreshing:u,refreshKey:p,handleMenuClick:b,handleOpenChange:y,handleUserMenuClick:f}=ee(),{user:k}=c(),x=k&&"object"==typeof k&&"realName"in k&&k.realName?String(k.realName):k&&"object"==typeof k&&"username"in k&&k.username?String(k.username):"ç®¡ç†å‘˜";return(0,Y.jsxs)(R,{className:"asp-comprehension-home",style:{height:"100vh",overflow:"hidden"},children:[(0,Y.jsxs)(le,{collapsible:!0,breakpoint:"md",className:"asp-comprehension-home-menu",collapsed:s,collapsedWidth:80,trigger:null,width:240,onBreakpoint:e=>{n(e)},children:[(0,Y.jsx)("div",{className:"asp-comprehension-home-menu-header",children:(0,Y.jsxs)("div",{className:"asp-comprehension-home-menu-logo",children:[(0,Y.jsx)("div",{className:"asp-comprehension-home-menu-logo-icon",children:(0,Y.jsx)(S,{})}),!s&&(0,Y.jsx)("span",{className:"asp-comprehension-home-menu-logo-title",children:"ä¸çŸ¥é“å«å•¥çš„æŸç³»ç»Ÿ"})]})}),s?(0,Y.jsx)("div",{className:"asp-comprehension-home-menu-search-collapsed",children:(0,Y.jsx)("div",{className:"asp-comprehension-home-menu-search-icon",onClick:()=>{n(!1)},children:(0,Y.jsx)(B,{})})}):(0,Y.jsx)("div",{className:"asp-comprehension-home-menu-search",children:(0,Y.jsx)(M,{allowClear:!0,placeholder:"æœç´¢èœå•",prefix:(0,Y.jsx)(B,{}),value:t,onChange:e=>l(e.target.value)})}),(0,Y.jsx)("div",{className:"asp-comprehension-home-menu-divider"}),t.trim()&&!s?(0,Y.jsxs)("div",{className:"asp-comprehension-home-menu-search-results",children:[(0,Y.jsxs)("div",{className:"asp-comprehension-home-menu-search-results-count",children:["å…±æœç´¢åˆ° ",h.length,' é¡¹ä¸Ž"',t,'"ç›¸å…³çš„èœå•']}),(0,Y.jsx)(D,{className:"asp-comprehension-home-menu-search-results-list",dataSource:h,renderItem:e=>(0,Y.jsx)(D.Item,{className:"asp-comprehension-home-menu-search-result-item "+(o.includes(e.key)?"asp-comprehension-home-menu-search-result-item-selected":""),onClick:()=>{e.key.startsWith("/")&&b({key:e.key})},children:(0,Y.jsxs)("div",{className:"asp-comprehension-home-menu-search-result-content",children:[e.icon&&(0,Y.jsx)("span",{className:"asp-comprehension-home-menu-search-result-icon",children:e.icon}),(0,Y.jsx)("span",{className:"asp-comprehension-home-menu-search-result-label",children:e.parentLabel?`${e.parentLabel} / ${e.label}`:e.label})]})})})]}):(0,Y.jsx)(K,{className:"asp-comprehension-home-menu-content",items:d,mode:"inline",openKeys:i,selectedKeys:o,theme:"light",onClick:b,onOpenChange:y})]}),(0,Y.jsxs)(R,{style:{height:"100%",overflow:"hidden"},children:[(0,Y.jsx)(te,{className:"asp-comprehension-home-header",children:(0,Y.jsxs)("div",{className:"asp-comprehension-home-header-content",children:[(0,Y.jsx)("div",{className:"asp-comprehension-home-header-left",children:(0,Y.jsx)("div",{className:"asp-comprehension-home-header-toggle",onClick:()=>n(!s),children:s?(0,Y.jsx)(v,{}):(0,Y.jsx)(N,{})})}),(0,Y.jsx)("div",{className:"asp-comprehension-home-header-center",children:(0,Y.jsx)(se,{})}),(0,Y.jsx)("div",{className:"asp-comprehension-home-header-right",children:(0,Y.jsxs)(P,{size:"middle",children:[(0,Y.jsx)(_,{}),(0,Y.jsx)(O,{menu:{items:F,onClick:f},placement:"bottomRight",children:(0,Y.jsxs)(P,{className:"asp-comprehension-home-header-content-user",style:{cursor:"pointer"},children:[(0,Y.jsx)(V,{icon:(0,Y.jsx)(H,{}),size:32,style:{backgroundColor:"#237ffa"}}),(0,Y.jsx)(re,{style:{fontSize:14,color:"#595959"},children:x})]})})]})})]})}),(0,Y.jsx)(ie,{className:"asp-comprehension-home-content",children:(0,Y.jsx)("div",{className:"asp-comprehension-home-content-wrapper",children:(0,Y.jsx)(A,{size:"large",spinning:m,style:{height:"100%"},tip:u?"é¡µé¢åˆ·æ–°ä¸­...":"é¡µé¢åŠ è½½ä¸­...",children:(0,Y.jsx)("div",{style:{height:"100%"},children:(0,Y.jsx)(J,{enableConsoleLog:!0,id:`Page-${e.pathname}`,children:(0,Y.jsx)(a,{},`${e.pathname}-${p}`)})})})})})]})]})},ce=()=>(0,Y.jsx)(ae,{children:(0,Y.jsx)(oe,{})});export{ce as default};