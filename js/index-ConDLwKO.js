import{i as e}from"./chunk-Dh7eWoLx.js";import{D as s,E as n,F as a,M as t,j as l,o as i,w as r}from"./chunk-DRz1mV9D.js";import{A as o,C as c,D as h,F as m,G as d,J as p,M as u,O as b,P as y,Q as f,R as k,S as g,U as x,_ as j,b as v,c as C,f as N,g as w,h as S,k as T,l as E,n as L,p as K,s as R,u as P,v as $,w as D,x as M,y as z,z as A}from"./chunk-y-UirLo8.js";import{_ as I}from"./chunk-DNO7pTiz.js";import{t as O}from"./chunk-CGT6cBuW.js";var W=e(a(),1),B=i();const F=[{key:"/",icon:(0,B.jsx)(h,{}),label:"首页"},{key:"dashboard",icon:(0,B.jsx)(k,{}),label:"仪表盘",children:[{key:"/dashboard/overview",icon:(0,B.jsx)(m,{}),label:"数据概览"},{key:"/dashboard/analysis",icon:(0,B.jsx)(k,{}),label:"统计分析"}]},{key:"documents",icon:(0,B.jsx)(T,{}),label:"文档管理",children:[{key:"/documents/list",icon:(0,B.jsx)(T,{}),label:"文档列表"},{key:"/documents/category",icon:(0,B.jsx)(b,{}),label:"文档分类"},{key:"/documents/trash",icon:(0,B.jsx)(u,{}),label:"回收站"}]},{key:"team",icon:(0,B.jsx)($,{}),label:"团队管理",children:[{key:"/team/members",icon:(0,B.jsx)(S,{}),label:"成员管理"},{key:"/team/roles",icon:(0,B.jsx)(w,{}),label:"角色权限"},{key:"/team/departments",icon:(0,B.jsx)($,{}),label:"部门管理"}]},{key:"barcode",icon:(0,B.jsx)(m,{}),label:"条码管理",children:[{key:"/barcode/manage",icon:(0,B.jsx)(m,{}),label:"条码生成"}]},{key:"settings",icon:(0,B.jsx)(z,{}),label:"系统设置",children:[{key:"/settings/basic",icon:(0,B.jsx)(z,{}),label:"基础设置"},{key:"/settings/security",icon:(0,B.jsx)(v,{}),label:"安全设置"},{key:"/settings/logs",icon:(0,B.jsx)(o,{}),label:"日志管理"}]},{key:"rndebug",icon:(0,B.jsx)(y,{}),label:"react native调试工具",children:[{key:"/smartserviceappDebug/debuglogs",icon:(0,B.jsx)(j,{}),label:"日志"},{key:"/smartserviceappDebug/network",icon:(0,B.jsx)(A,{}),label:"网络"}]}],_=[{key:"profile",icon:(0,B.jsx)(w,{}),label:"个人中心"},{key:"settings",icon:(0,B.jsx)(z,{}),label:"账户设置"},{type:"divider"},{key:"logout",icon:(0,B.jsx)(D,{}),label:"退出登录",danger:!0}];var G=(0,W.createContext)(void 0),H=e=>{const s=n=>{for(const a of n)if(a&&"string"!=typeof a){if(a.key===e&&"label"in a&&a.label)return"string"==typeof a.label?a.label:String(a.label);if("children"in a&&a.children){const e=s(a.children);if(e)return e}}return null};return s(F||[])||"未命名页面"};const J=({children:e})=>{const a=n(),t=s(),[l,i]=(0,W.useState)([{key:"/",label:"首页",path:"/",closable:!1}]),[r,o]=(0,W.useState)("/"),[c,h]=(0,W.useState)(""),[m,d]=(0,W.useState)(null),[p,u]=(0,W.useState)(!1),b=(0,W.useCallback)(e=>{i(s=>{if(s.find(s=>s.path===e))return s;const n={key:e,label:H(e),path:e,closable:"/"!==e};return[...s,n]}),o(e)},[]),y=(0,W.useCallback)(e=>{i(s=>{const n=s.filter(s=>s.key!==e);if(e===r&&n.length>0){const a=s.findIndex(s=>s.key===e),l=n[a>0?a-1:0];l&&(o(l.key),t(l.path))}return n})},[r,t]),f=(0,W.useCallback)(e=>{o(e);const s=l.find(s=>s.key===e);s&&(u(!0),t(s.path),setTimeout(()=>{u(!1)},100))},[l,t]),k=(0,W.useCallback)(e=>{i(s=>s.filter(s=>s.key===e||!s.closable)),o(e);const s=l.find(s=>s.key===e);s&&t(s.path)},[l,t]),g=(0,W.useCallback)(()=>{i(e=>e.filter(e=>!e.closable)),o("/"),t("/")},[t]),x=(0,W.useCallback)(e=>{const s=l.find(s=>s.key===e);s&&(d(e),window.dispatchEvent(new CustomEvent("tab-refresh",{detail:{path:s.path,key:e}})),h(`${s.path}-${Date.now()}`),e!==r&&t(s.path))},[l,t,r]);return(0,W.useEffect)(()=>{b(a.pathname||"/")},[a.pathname,b]),(0,W.useEffect)(()=>{o(a.pathname||"/")},[a.pathname]),(0,B.jsx)(G.Provider,{value:{tabs:l,activeKey:r,refreshKey:c,refreshingKey:m,isTabSwitching:p,addTab:b,removeTab:y,setActiveTab:f,closeOtherTabs:k,closeAllTabs:g,refreshTab:x,setRefreshingKey:d,setIsTabSwitching:u},children:e})},Q=()=>{const e=(0,W.useContext)(G);if(!e)throw new Error("useTabs must be used within TabsProvider");return e};var U=()=>{const{tabs:e,activeKey:s,setActiveTab:n,removeTab:a,closeOtherTabs:t,refreshTab:l}=Q(),i=(0,W.useRef)(null),r=(0,W.useRef)(null),[o,c]=(0,W.useState)(new Set);(0,W.useEffect)(()=>{if(r.current&&i.current){const e=i.current,s=r.current,n=e.getBoundingClientRect(),a=s.getBoundingClientRect();a.left<n.left?e.scrollLeft=s.offsetLeft-20:a.right>n.right&&(e.scrollLeft=s.offsetLeft-n.width+a.width+20)}},[s]);return(0,B.jsx)("div",{className:"asp-tabs-bar",children:(0,B.jsx)("div",{ref:i,className:"asp-tabs-bar-container",children:e.map(i=>{const h=i.key===s;return(0,B.jsxs)("div",{ref:h?r:null,className:"asp-tabs-bar-item "+(h?"active":""),onClick:e=>((e,a)=>{a.stopPropagation(),e.key!==s&&n(e.key)})(i,e),onContextMenu:s=>((s,n)=>{n.preventDefault(),n.stopPropagation(),s.closable&&e.length>1&&t(s.key)})(i,s),children:[h&&(0,B.jsx)("span",{className:"asp-tabs-bar-item-refresh "+(o.has(i.key)?"refreshing":""),title:"刷新页面",onClick:e=>((e,s)=>{s.stopPropagation(),c(s=>new Set(s).add(e.key)),l(e.key),setTimeout(()=>{c(s=>{const n=new Set(s);return n.delete(e.key),n})},500)})(i,e),children:(0,B.jsx)(M,{})}),(0,B.jsx)("span",{className:"asp-tabs-bar-item-label",children:i.label}),i.closable&&(0,B.jsx)("span",{className:"asp-tabs-bar-item-close",title:"关闭标签",onClick:e=>((e,s)=>{s.stopPropagation(),a(e.key)})(i,e),children:(0,B.jsx)(f,{})})]},i.key)})})})};t();var{Header:q,Sider:V,Content:X}=E,{Text:Y}=L,Z=()=>{const[e,a]=(0,W.useState)(!1),[t,i]=(0,W.useState)(""),o=s(),h=n(),{refreshKey:m,refreshingKey:u,setRefreshingKey:b,isTabSwitching:y}=Q(),[f,j]=(0,W.useState)(!1),v=(0,W.useRef)(null),{logout:S}=I(),T=(0,W.useMemo)(()=>{const e=h.pathname||"/",s=[];return null==F||F.forEach(n=>{n&&"string"!=typeof n&&("/"!==n.key||"/"!==e&&""!==e?n.key===e?s.push(e):"children"in n&&n.children&&n.children.forEach(n=>{n&&"string"!=typeof n&&n.key===e&&s.push(e)}):s.push("/"))}),s.length>0?s:["/"]},[h.pathname]),L=e=>{const s=[];return null==F||F.forEach(n=>{n&&"string"!=typeof n&&"children"in n&&n.children&&n.children.some(s=>s&&"string"!=typeof s&&s.key===e)&&n.key&&s.push(n.key)}),s},[$,D]=(0,W.useState)(()=>L(h.pathname||"/")),M=(0,W.useMemo)(()=>t.trim()?((e,s)=>{const n=[],a=s.toLowerCase();return null==e||e.forEach(e=>{if(!e||"string"==typeof e||"divider"===e.type)return;const s="label"in e&&e.label?e.label.toString():"",t=s.toLowerCase();"children"in e&&e.children?(e.children.forEach(e=>{if(!e||"string"==typeof e||"divider"===e.type)return;const t="label"in e&&e.label?e.label.toString():"";t.toLowerCase().includes(a)&&n.push({key:e.key,label:t,parentLabel:s,icon:"icon"in e?e.icon:void 0})}),t.includes(a)&&e.key&&"string"==typeof e.key&&e.key.startsWith("/")&&n.push({key:e.key,label:s,icon:"icon"in e?e.icon:void 0})):t.includes(a)&&n.push({key:e.key,label:s,icon:"icon"in e?e.icon:void 0})}),n})(F,t):[],[t]),z=(0,W.useMemo)(()=>((e,s)=>{if(!s.trim())return e;const n=[];return null==e||e.forEach(e=>{if(!e||"string"==typeof e||"divider"===e.type)return;const a="label"in e&&e.label?e.label.toString().toLowerCase():"",t=s.toLowerCase();if("children"in e&&e.children){const s=e.children.filter(e=>!(!e||"string"==typeof e||"divider"===e.type)&&("label"in e&&e.label?e.label.toString().toLowerCase():"").includes(t));(a.includes(t)||s.length>0)&&n.push(l(l({},e),{},{children:s.length>0?s:e.children}))}else a.includes(t)&&n.push(e)}),n})(F,t),[t]);(0,W.useEffect)(()=>{if(t.trim()){const e=[];null==F||F.forEach(s=>{s&&"string"!=typeof s&&"divider"!==s.type&&"children"in s&&s.children&&s.children.some(e=>!(!e||"string"==typeof e||"divider"===e.type)&&("label"in e&&e.label?e.label.toString().toLowerCase():"").includes(t.toLowerCase()))&&s.key&&e.push(s.key)}),D(e)}else D(L(h.pathname||"/"))},[t]);(0,W.useEffect)(()=>{const e=h.pathname||"/";if(null!==v.current&&v.current!==e&&!y){j(!0);const s=setTimeout(()=>{j(!1)},300);return v.current=e,()=>{clearTimeout(s)}}v.current=e},[h.pathname,y]),(0,W.useEffect)(()=>{if(u&&m){const e=setTimeout(()=>{b(null)},300);return()=>{clearTimeout(e)}}},[m,u,b]);const A=h.pathname||"/",G=null!==u&&u===A,H=G||f;return(0,B.jsxs)(E,{className:"asp-comprehension-home",style:{height:"100vh",overflow:"hidden"},children:[(0,B.jsxs)(V,{collapsible:!0,breakpoint:"md",className:"asp-comprehension-home-menu",collapsed:e,collapsedWidth:80,trigger:null,width:240,onBreakpoint:e=>{a(e)},children:[(0,B.jsx)("div",{className:"asp-comprehension-home-menu-header",children:(0,B.jsxs)("div",{className:"asp-comprehension-home-menu-logo",children:[(0,B.jsx)("div",{className:"asp-comprehension-home-menu-logo-icon",children:(0,B.jsx)(k,{})}),!e&&(0,B.jsx)("span",{className:"asp-comprehension-home-menu-logo-title",children:"不知道叫啥的某系统"})]})}),e?(0,B.jsx)("div",{className:"asp-comprehension-home-menu-search-collapsed",children:(0,B.jsx)("div",{className:"asp-comprehension-home-menu-search-icon",onClick:()=>{a(!1)},children:(0,B.jsx)(p,{})})}):(0,B.jsx)("div",{className:"asp-comprehension-home-menu-search",children:(0,B.jsx)(P,{allowClear:!0,placeholder:"搜索菜单",prefix:(0,B.jsx)(p,{}),value:t,onChange:e=>i(e.target.value)})}),(0,B.jsx)("div",{className:"asp-comprehension-home-menu-divider"}),t.trim()&&!e?(0,B.jsxs)("div",{className:"asp-comprehension-home-menu-search-results",children:[(0,B.jsxs)("div",{className:"asp-comprehension-home-menu-search-results-count",children:["共搜索到 ",M.length,' 项与"',t,'"相关的菜单']}),(0,B.jsx)(R,{className:"asp-comprehension-home-menu-search-results-list",dataSource:M,renderItem:e=>(0,B.jsx)(R.Item,{className:"asp-comprehension-home-menu-search-result-item "+(T.includes(e.key)?"asp-comprehension-home-menu-search-result-item-selected":""),onClick:()=>{e.key.startsWith("/")&&o(e.key)},children:(0,B.jsxs)("div",{className:"asp-comprehension-home-menu-search-result-content",children:[e.icon&&(0,B.jsx)("span",{className:"asp-comprehension-home-menu-search-result-icon",children:e.icon}),(0,B.jsx)("span",{className:"asp-comprehension-home-menu-search-result-label",children:e.parentLabel?`${e.parentLabel} / ${e.label}`:e.label})]})})})]}):(0,B.jsx)(x,{className:"asp-comprehension-home-menu-content",items:z,mode:"inline",openKeys:$,selectedKeys:T,theme:"light",onClick:({key:e})=>{e.startsWith("/")&&o(e)},onOpenChange:e=>{D(e)}})]}),(0,B.jsxs)(E,{style:{height:"100%",overflow:"hidden"},children:[(0,B.jsx)(q,{className:"asp-comprehension-home-header",children:(0,B.jsxs)("div",{className:"asp-comprehension-home-header-content",children:[(0,B.jsx)("div",{className:"asp-comprehension-home-header-left",children:(0,B.jsx)("div",{className:"asp-comprehension-home-header-toggle",onClick:()=>a(!e),children:e?(0,B.jsx)(g,{}):(0,B.jsx)(c,{})})}),(0,B.jsx)("div",{className:"asp-comprehension-home-header-center",children:(0,B.jsx)(U,{})}),(0,B.jsx)("div",{className:"asp-comprehension-home-header-right",children:(0,B.jsx)(N,{menu:{items:_,onClick:({key:e})=>{"logout"===e?S().then(()=>{o("/login",{replace:!0})}):"profile"===e?o("/profile"):"settings"===e&&o("/settings/basic")}},placement:"bottomRight",children:(0,B.jsxs)(K,{className:"asp-comprehension-home-header-content-user",style:{cursor:"pointer"},children:[(0,B.jsx)(d,{icon:(0,B.jsx)(w,{}),size:32,style:{backgroundColor:"#237ffa"}}),(0,B.jsx)(Y,{style:{fontSize:14,color:"#595959"},children:"管理员"})]})})})]})}),(0,B.jsx)(X,{className:"asp-comprehension-home-content",children:(0,B.jsx)("div",{className:"asp-comprehension-home-content-wrapper",children:(0,B.jsx)(C,{size:"large",spinning:H,style:{height:"100%"},tip:G?"页面刷新中...":"页面加载中...",children:(0,B.jsx)("div",{style:{height:"100%"},children:(0,B.jsx)(O,{enableConsoleLog:!0,id:`Page-${h.pathname}`,children:(0,B.jsx)(r,{},`${h.pathname}-${m}`)})})})})})]})]})},ee=()=>(0,B.jsx)(J,{children:(0,B.jsx)(Z,{})});export{ee as default};