import{i as e}from"./chunk-Dh7eWoLx.js";import{_ as r,a as n,b as t,g as o,i as s,s as i,v as a,x as c,y as d}from"./chunk-Df8qoxrw.js";import{o as l,q as u,t as f}from"./chunk-CrN5YlxA.js";import"./chunk-B7qJg6fJ.js";import{n as p}from"./chunk-BczMEAkl.js";import{t as h}from"./chunk-DudTnYeX.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)}).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();var m=e(f(),1),g=n(),y=e(c(),1);a();var v,x=!1,j=(v=o(function*(e){yield fetch("/mock-api/client-error-report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}),function(e){return v.apply(this,arguments)}),k=e=>{try{return"string"==typeof e?e:JSON.stringify(e)}catch(r){return String(e)}};const w=(b=o(function*(e){const n=(e=>{const n="undefined"!=typeof window&&window.location?window.location.href:"N/A",t="undefined"!=typeof navigator?navigator.userAgent:"N/A";return r(r({},e),{},{url:n,userAgent:t,timestamp:Date.now()})})(e);try{yield j(n)}catch(t){}}),function(e){return b.apply(this,arguments)});var b;var E=s();t();var S=class extends y.Component{constructor(...e){super(...e),d(this,"state",{hasError:!1,message:""}),d(this,"handleRetry",()=>{this.setState({hasError:!1,message:""})})}static getDerivedStateFromError(e){return{hasError:!0,message:String((null==e?void 0:e.message)||"未知错误")}}componentDidCatch(e,r){w({type:"react-render",scope:this.props.scope||"App",message:(null==e?void 0:e.message)||"组件渲染异常",stack:null==e?void 0:e.stack,componentStack:r.componentStack||void 0})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,E.jsxs)("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:12,color:"#1f1f1f",background:"#f5f5f5"},children:[(0,E.jsx)("div",{style:{fontSize:18,fontWeight:600},children:"页面出错了"}),(0,E.jsx)("div",{style:{color:"#8c8c8c"},children:this.state.message||"请稍后重试"}),(0,E.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,E.jsx)("button",{style:{padding:"8px 16px",borderRadius:6,border:"1px solid #1677ff",background:"#1677ff",color:"#fff",cursor:"pointer"},onClick:()=>window.location.reload(),children:"刷新页面"}),(0,E.jsx)("button",{style:{padding:"8px 16px",borderRadius:6,border:"1px solid #d9d9d9",background:"#fff",color:"#595959",cursor:"pointer"},onClick:this.handleRetry,children:"重试"})]})]}):this.props.children}},L=({children:e})=>((0,y.useEffect)(()=>{const e=(()=>{if("undefined"==typeof window||x)return;x=!0;const e=e=>{var r;w({type:"runtime-error",message:e.message,stack:null===(r=e.error)||void 0===r?void 0:r.stack,filename:e.filename,lineno:e.lineno,colno:e.colno,extra:{error:k(e.error)}})},r=e=>{const r=e.reason;w({type:"unhandled-rejection",message:(null==r?void 0:r.message)||k(r)||"Unhandled rejection",stack:null==r?void 0:r.stack,extra:{reason:k(r)}})};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",r),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",r),x=!1}})();return()=>{e&&e()}},[]),(0,E.jsx)(E.Fragment,{children:e})),N=()=>(0,E.jsx)("div",{className:"loading-fallback",children:(0,E.jsx)(l,{spinning:!0,size:"large",tip:"页面加载中...",children:(0,E.jsx)("div",{className:"loading-fallback-placeholder"})})}),A=({children:e})=>{const{logPagePerformance:r}=p();return(0,y.useEffect)(()=>{const e=()=>{setTimeout(()=>{r()},1e3)};if("complete"!==document.readyState)return window.addEventListener("load",e),()=>{window.removeEventListener("load",e)};e()},[r]),(0,E.jsx)(E.Fragment,{children:e})};(0,g.createRoot)(document.getElementById("root")).render((0,E.jsx)(L,{children:(0,E.jsx)(S,{scope:"AppRoot",children:(0,E.jsx)(u,{locale:m.default,children:(0,E.jsx)(A,{children:(0,E.jsx)(y.Suspense,{fallback:(0,E.jsx)(N,{}),children:(0,E.jsx)(i,{router:h})})})})})}));